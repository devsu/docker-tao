# docker-tao
Docker images for building and running [TAO Assessment Platform](https://www.taotesting.com/)

## Usage

The easiest way to run tao is using docker-compose. 

1. Clone this repo (or just copy the files in the `example` folder).
2. Modify the `tao/docker-compose.yml` and `tao/nginx` according to your needs.
3. Then just run `docker-compose up` from the `example` folder.

Then just head to http://localhost to start installation.

At installation make sure that you choose the following folder to store data: `/var/lib/tao/data`. As you can see in `Dockerfile`, a volume has been defined for this folder. 

Since this folder is created only in the `tao` image, it won't be accessible by the `web` container, which is good for security reasons.

## Approach

The `tao` image is built using [multi-stage builds](https://docs.docker.com/develop/develop-images/multistage-build/).

- The **builder** image downloads the code and install all required packages
- The **runner** image copies the code generated by the builder and installs the runtime dependencies.

The runner is a `php-fpm` image, and thus it requires a **nginx** instance in front of it to serve the application.

The `example/docker-compose.yml` shows how to use it. It defines 2 services:

- **tao**: The container that will run the application.
- **web**: An nginx web server.

Both images share a named volume, which contain the application code.

All images are built in top of Linux alpine, to avoid issues of different ids for the `www-data` user. 

## Building TAO

As you can see in the Dockerfile, TAO is built from the source code releases at https://github.com/oat-sa/package-tao/releases.

It's published in docker-hub at https://hub.docker.com/repository/docker/devsu/tao, but if you want, you can build it yourself. 

```
docker build --target builder -t tao
```

It's configured to use the latest tao version at moment, but you can easily change the version by passing the `TAO_VERSION` argument.

```
docker build --target builder -t tao --build-arg TAO_VERSION=3.3-rc02
```

The version must match the version used in the name of the source code zip file.

## Development

If you want to test the docker files as you change them, you need to use the `docker-compose-dev.yml` file instead. 

```
docker-compose -f docker-compose-file-dev.yml up --build 
```

## Credits

Thanks to [Open Assessment Technologies](https://www.taotesting.com/about-us/) for the awesome work, and for sharing it with the world.

Inspired on https://github.com/Alroniks/docker-tao.

This repo is maintained by Devsu, and it's used to take assessments to [find the best software developers](https://devsu.com/about-us/).

## License

MIT License - Copyright (c) 2020 Devsu LLC
